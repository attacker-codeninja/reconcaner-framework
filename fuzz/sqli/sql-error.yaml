id: sqli-param-fuzz-01
type: fuzz
info:
  name: SQL Injection on Parameter 01
  risk: High


payloads:
  - >-
    '
  - >-
    %
  - >-
    \"
  - >-
    `
  - >-
    %25%27%25%22
  - >-
    %u0027%u0022
  - >-
    %c0%a7
  - >-
    %0aa%0db
  - >-
    1e309
  - >-
    char(0x27)char(0x27)
  - >-
    %u2018
  - >-
    /*

requests:
  - generators:
      - Query("[[.original]]{{.payload}}")
    detections:
      - >-
        (StatusCode() >= 500) && RegexSearch("response", "Internal Server Error")
      - >-
        RegexSearch("response", "mysql_fetch_|not a valid MySQL|not a legal PLSQL identifer|mysql_connect\(\)|(SELECT\s+[^:>]+\sFROM\s+[^:>]+\sWHERE\s+)|(at\s[[:alnum:]\/\._]+\sline\s\d+)|ociparse\(\):|must be a syntactically valid variable|CFSQLTYPE|Unknown column '|Microsoft OLE DB Provider for SQL|SQL QUERY FAILURE:|Syntax error.{1,50}in query|You have an error in your SQL syntax|Unclosed quotation mark")
      - >-
        RegexSearch("response", "SQL syntax.*MySQL|Warning.*mysql_.*|valid MySQL result|MySqlClient\.|PostgreSQL.*ERROR|Warning.*\Wpg_.*|valid PostgreSQL result|Npgsql\.|Driver.* SQL[\-\_\ ]*Server|OLE DB.* SQL Server|(\W|\A)SQL Server.*Driver|Warning.*mssql_.*|(\W|\A)SQL Server.*[0-9a-fA-F]{8}|(?s)Exception.*\WSystem\.Data\.SqlClient\.|(?s)Exception.*\WRoadhouse\.Cms\.|Microsoft Access Driver|JET Database Engine|Access Database Engine|\bORA-[0-9][0-9][0-9][0-9]|Oracle error|Oracle.*Driver|Warning.*\Woci_.*|Warning.*\Wora_.*||CLI Driver.*DB2|DB2 SQL error|\bdb2_\w+\("||SQLite/JDBCDriver|SQLite.Exception|System.Data.SQLite.SQLiteException|Warning.*sqlite_.*|Warning.*SQLite3::|\[SQLITE_ERROR\]|Warning.*sybase.*|Sybase message|Sybase.*Server message.*")